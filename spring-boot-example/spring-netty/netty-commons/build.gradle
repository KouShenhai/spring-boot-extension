plugins {
    id "com.livk.common"
    alias(libs.plugins.google.protobuf)
}

dependencies {
    api "io.netty:netty-all"
    api "com.google.protobuf:protobuf-java"
}

compileJava {
    dependsOn("generateProto")
}

sourceSets {
    main {
        proto {
            srcDir "src/main/protobuf"
        }
    }
}

protobuf {
    protoc {
        artifact = "com.google.protobuf:protoc:3.23.2"
    }

    plugins {
        grpc {
            artifact = "io.grpc:protoc-gen-grpc-java:1.53.0"
        }
    }

    generateProtoTasks {
        ofSourceSet("main").configureEach {
            plugins {
                grpc {}
            }
        }
    }
}
